<app-headermenu></app-headermenu>

<section id="content">
    <br />
    <h1 style="text-align: center;">Lista de Usuarios</h1>
  
    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>Correo</th>
            <th>Fecha de Creación</th>
            <th>Última Modificación</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody id="tablaUsuarios">
          <tr *ngFor="let user of users">
            <td>{{ user.correo }}</td>
            <td>{{ user.created_at | date }}</td>
            <td>{{ user.updated_at | date }}</td>
            <td>
              <button (click)="openEditModal(user)"><i class='bx bx-edit'></i></button>
              <button (click)="openDeleteModal(user)"><i class='bx bx-trash'></i></button>
            </td>
          </tr>
          <tr *ngIf="users.length === 0">
            <td colspan="4" class="no-data">No hay Usuarios Disponibles</td>
          </tr>
        </tbody>
      </table>
    </div>

       <!-- Modal para agregar/editar usuario -->
<div id="modal" class="modal" *ngIf="showAddModal || showEditModal">
  <div class="modal-contenido">
    <span (click)="showAddModal ? closeAddModal() : closeEditModal()" class="cerrar">&times;</span>
    <h2>{{ showAddModal ? 'Agregar Usuario' : 'Editar Usuario' }}</h2>
    <form [formGroup]="usersForm" (ngSubmit)="showAddModal ? addUsers() : updateUsers()">
      <label for="correo">Correo:</label>
      <input type="email" id="correo" formControlName="correo" required placeholder="Ingrese el Correo" (input)="validarCorreo()" maxlength="60"/>
      <span *ngIf="usersForm.get('correo')?.invalid && usersForm.get('correo')?.touched" class="error-message">
        El Correo es obligatorio
      </span>
      <label for="contrasenia">Contraseña:</label>
      <input type="password" id="contrasenia" formControlName="contrasenia" required placeholder="Ingrese la Contraseña" maxlength="255"/>
      <span *ngIf="usersForm.get('contrasenia')?.invalid && usersForm.get('contrasenia')?.touched" class="error-message">
        La Contraseña es obligatorio
      </span>
      <button type="submit">
        <i class="bx bx-save"></i> {{ showAddModal ? 'Guardar' : 'Actualizar' }}
      </button>
    </form>
  </div>
</div>

<!-- Modal de confirmación para eliminar usuario -->
<div id="modalConfirmacion" class="modal" *ngIf="showDeleteModal">
  <div class="modal-contenido">
    <p>¿Quieres eliminar este usuario?</p>
    <button class="btnEliminar" (click)="deleteUsers()">
      <i class="bx bx-trash"></i> Eliminar
    </button>
    <button (click)="closeDeleteModal()">Cancelar</button>
  </div>
</div>
</section>